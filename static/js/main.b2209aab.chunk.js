(this["webpackJsonptrivia-test"]=this["webpackJsonptrivia-test"]||[]).push([[0],{110:function(e,t){},112:function(e,t,n){e.exports=n.p+"static/media/trivia.466d153e.png"},114:function(e,t,n){e.exports=n(219)},130:function(e,t){},132:function(e,t){},165:function(e,t){},166:function(e,t){},172:function(e,t){},209:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},212:function(e,t,n){},213:function(e,t,n){},214:function(e,t,n){},216:function(e,t,n){},217:function(e,t,n){},218:function(e,t,n){},219:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(46),s=n.n(c),i=n(12),o=n(24),u=n(27),l=n(108),p=n(109),m=n(110),d=n.n(m),f=n(15),h=n(3),b=n.n(h),v=n(111),y=n.n(v),g=function(){if(!localStorage.getItem("ranking")){var e=JSON.stringify([]);localStorage.setItem("ranking",e)}},E=function(){var e=JSON.parse(localStorage.getItem("token"));return e||"no token in storage"},O=function(e){var t=JSON.stringify(e);localStorage.setItem("token",t)},S=function(){var e,t,n;return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.a.awrap(fetch("https://opentdb.com/api_token.php?command=request"));case 2:return e=a.sent,a.next=5,b.a.awrap(e.json());case 5:return t=a.sent,n=t.token,O(n),a.abrupt("return",n);case 9:case"end":return a.stop()}}))},k=function(e,t){var n,a,r,c,s,i,o,u;return b.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n=3,a=t.selectedCategory,r=t.selectedDifficulty,c=t.selectedType,s="".concat("https://opentdb.com/api.php?encode=base64&amount=5&token=").concat(e,"&category=").concat(a,"&difficulty=").concat(r,"&type=").concat(c),l.next=5,b.a.awrap(fetch(s));case 5:return i=l.sent,l.next=8,b.a.awrap(i.json());case 8:if((o=l.sent).response_code!==n){l.next=11;break}return l.abrupt("return","token expired");case 11:return(u=o.results).forEach((function(e){e.question=window.atob(e.question),e.category=window.atob(e.category),e.type=window.atob(e.type),e.difficulty=window.atob(e.difficulty),e.correct_answer=window.atob(e.correct_answer),e.incorrect_answers[0]=window.atob(e.incorrect_answers[0]),e.incorrect_answers.length>1&&(e.incorrect_answers[1]=window.atob(e.incorrect_answers[1]),e.incorrect_answers[2]=window.atob(e.incorrect_answers[2]))})),l.abrupt("return",u);case 14:case"end":return l.stop()}}))},w=function(e){var t,n;return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=y()(e).toString(),a.next=3,b.a.awrap(fetch("https://www.gravatar.com/avatar/".concat(t)));case 3:return n=a.sent,a.abrupt("return",n.url);case 5:case"end":return a.stop()}}))},j=function(e){return{type:"SAVE_AVATAR",avatar:e}},T=function(e){return{type:"SAVE_TOKEN",token:e}},C={name:"",assertions:0,score:0,gravatarEmail:"",gravatarUrl:""},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_USER":return Object(f.a)({},e,{name:t.user.name,gravatarEmail:t.user.email});case"INCREASE_SCORE":return Object(f.a)({},e,{score:e.score+t.points});case"INCREASE_ASSERTIONS":return Object(f.a)({},e,{assertions:e.assertions+1});case"SAVE_AVATAR":return Object(f.a)({},e,{gravatarUrl:t.avatar});case"RESET_ASSERTIONS":return Object(f.a)({},e,{assertions:0,score:0});default:return e}},A={time:30,stopTime:!1,score:0,amount:5,token:"",categories:[],questions:[],selectedCategory:"",selectedDifficulty:"",selectedType:""},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DECREASE_TIME":return Object(f.a)({},e,{time:e.time-1});case"STOP_TIME":return Object(f.a)({},e,{stopTime:!0});case"RESET_TIME":return Object(f.a)({},e,{time:30,stopTime:!1});case"SAVE_CATEGORIES":return Object(f.a)({},e,{categories:t.categories});case"SAVE_SETTINGS":return Object(f.a)({},e,{},t.settings);case"SAVE_TOKEN":return Object(f.a)({},e,{token:t.token});default:return e}},N=Object(u.combineReducers)({user:d.a,game:_,player:x}),I=Object(u.createStore)(N,Object(l.composeWithDevTools)(Object(u.applyMiddleware)(p.a)));window.Cypress&&(window.store=I);var D=I,R=n(5),q=n(6),H=n(8),M=n(7),B=n(9),J=n(28),P=n(33),F=n(10),U=(n(209),n(112)),V=n.n(U),Q=function(e){function t(e){var n;return Object(R.a)(this,t),(n=Object(H.a)(this,Object(M.a)(t).call(this,e))).state={email:"",name:"",btnDisable:!0},n.onChangeHandler=n.onChangeHandler.bind(Object(F.a)(n)),n.onClickHandler=n.onClickHandler.bind(Object(F.a)(n)),n}return Object(B.a)(t,e),Object(q.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.tokenFetch)()}},{key:"onChangeHandler",value:function(e){var t=this,n=e.target;this.setState(Object(P.a)({},n.name,n.value),(function(){var e=t.state,n=e.email,a=e.name;n.length&&a.length?t.setState({btnDisable:!1}):t.setState({btnDisable:!0})}))}},{key:"onClickHandler",value:function(){var e,t,n,a,r,c,s,i,o,u;return b.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props,t=e.add,n=e.history,a=e.playerState,r=e.avatarFetch,c=e.resetTimeAction,s=e.resetAssertionsAction,i=this.state,o=i.email,u=i.name,l.next=4,b.a.awrap(t({email:o,name:u}));case 4:return l.next=6,b.a.awrap(r(o));case 6:localStorage.setItem("state",JSON.stringify({player:a})),n.push("/game"),c(),s();case 10:case"end":return l.stop()}}),null,this)}},{key:"render",value:function(){var e=this.state,t=e.email,n=e.name,a=e.btnDisable,c=this.props.history;return r.a.createElement("div",{className:"login"},r.a.createElement("div",null,r.a.createElement("img",{src:V.a,alt:""})),r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"email-input"},r.a.createElement("input",{type:"email","data-testid":"input-gravatar-email",id:"email-input",name:"email",placeholder:"Email",value:t,onChange:this.onChangeHandler})),r.a.createElement("label",{htmlFor:"name-input"},r.a.createElement("input",{type:"name","data-testid":"input-player-name",id:"name-input",name:"name",placeholder:"Apelido",value:n,onChange:this.onChangeHandler})),r.a.createElement("input",{className:"jogar-btn",type:"button","data-testid":"btn-play",disabled:a,value:"Jogar",onClick:this.onClickHandler})),r.a.createElement("input",{"data-testid":"btn-settings",type:"button",value:"Settings",onClick:function(){return c.push("/settings")}}))}}]),t}(r.a.Component),G=Object(i.b)((function(e){return{playerState:e.player}}),(function(e){return{add:function(t){return e(function(e){return{type:"ADD_USER",user:e}}(t))},avatarFetch:function(t){return e(function(e){return function(t){var n;return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,b.a.awrap(w(e));case 3:n=a.sent,t(j(n)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}}),null,null,[[0,7]])}}(t))},tokenFetch:function(){return e((function(e){var t;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b.a.awrap(S());case 3:t=n.sent,e(T(t)),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0);case 10:case"end":return n.stop()}}),null,null,[[0,7]])}))},resetTimeAction:function(){return e({type:"RESET_TIME"})},resetAssertionsAction:function(){return e({type:"RESET_ASSERTIONS"})}}}))(Q),L=(n(210),function(e){function t(e){var n;return Object(R.a)(this,t),(n=Object(H.a)(this,Object(M.a)(t).call(this,e))).state={selectedCategory:"",selectedDifficulty:"",selectedType:""},n.onChangeHandler=n.onChangeHandler.bind(Object(F.a)(n)),n.onClickHandler=n.onClickHandler.bind(Object(F.a)(n)),n}return Object(B.a)(t,e),Object(q.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.categoriesFetch)()}},{key:"onChangeHandler",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(P.a)({},n,a))}},{key:"onClickHandler",value:function(){var e=this.props,t=e.settingsSave,n=e.history;t(this.state),n.push("/")}},{key:"render",value:function(){var e=this.state,t=e.selectedCategory,n=e.selectedDifficulty,a=e.selectedType,c=this.props.categories;return r.a.createElement("div",{className:"settings"},r.a.createElement("h1",{"data-testid":"settings-title"},"Settings"),r.a.createElement("form",{action:""},r.a.createElement("label",{htmlFor:"selectedCategory-select"},"Category",r.a.createElement("select",{name:"selectedCategory",id:"selectedCategory-select",value:t,onChange:this.onChangeHandler},c.map((function(e){var t=e.id,n=e.name;return r.a.createElement("option",{key:t,value:t},n)})))),r.a.createElement("label",{htmlFor:"selectedDifficulty-select"},"Difficulty",r.a.createElement("select",{name:"selectedDifficulty",id:"selectedDifficulty-select",value:n,onChange:this.onChangeHandler},r.a.createElement("option",{value:"easy"},"Easy"),r.a.createElement("option",{value:"medium"},"Medium"),r.a.createElement("option",{value:"hard"},"Hard"))),r.a.createElement("label",{htmlFor:"selectedType-select"},"Type",r.a.createElement("select",{name:"selectedType",id:"selectedType-select",value:a,onChange:this.onChangeHandler},r.a.createElement("option",{value:"multiple"},"Multiple"),r.a.createElement("option",{value:"boolean"},"Boolean"))),r.a.createElement("input",{type:"button",value:"Save",onClick:this.onClickHandler})))}}]),t}(r.a.Component)),K=Object(i.b)((function(e){return{categories:e.game.categories}}),(function(e){return{categoriesFetch:function(){return e((function(e){var t,n;return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,b.a.awrap(fetch("https://opentdb.com/api_category.php"));case 3:return t=a.sent,a.next=6,b.a.awrap(t.json());case 6:n=a.sent,e({type:"SAVE_CATEGORIES",categories:n.trivia_categories}),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),console.log(a.t0);case 13:case"end":return a.stop()}}),null,null,[[0,10]])}))},settingsSave:function(t){return e(function(e){return{type:"SAVE_SETTINGS",settings:e}}(t))}}}))(L),W=n(48),z=(n(211),function(e){function t(){return Object(R.a)(this,t),Object(H.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(B.a)(t,e),Object(q.a)(t,[{key:"render",value:function(){var e=this.props,t=e.userName,n=e.score,a=e.gravatarUrl;return r.a.createElement("header",null,r.a.createElement("div",{className:"userInfo"},r.a.createElement("img",{"data-testid":"header-profile-picture",className:"avatar",src:a,alt:"Icone do Avatar"}),r.a.createElement("h2",{"data-testid":"header-player-name",className:"userName"},"Jogador: ".concat(t))),r.a.createElement("div",{className:"scoreBoard"},r.a.createElement("h4",{"data-testid":"header-score",className:"score"},n)))}}]),t}(r.a.Component)),X=Object(i.b)((function(e){return{userName:e.player.name,score:e.player.score,gravatarUrl:e.player.gravatarUrl}}))(z),Y=(n(212),n(213),function(e){function t(){var e;return Object(R.a)(this,t),(e=Object(H.a)(this,Object(M.a)(t).call(this))).nextQuestion=e.nextQuestion.bind(Object(F.a)(e)),e}return Object(B.a)(t,e),Object(q.a)(t,[{key:"nextQuestion",value:function(){var e=this.props,t=e.funct,n=e.resetStyles;t(),n()}},{key:"render",value:function(){return r.a.createElement("input",{className:"next-button",type:"button",value:"Pr\xf3xima","data-testid":"btn-next",onClick:this.nextQuestion})}}]),t}(r.a.Component)),Z=function(e){function t(e){var n;return Object(R.a)(this,t),(n=Object(H.a)(this,Object(M.a)(t).call(this,e))).state={answers:[],correctBtnClass:"",incorrectBtnClass:"",answered:!1},n.shuffleAnswers=n.shuffleAnswers.bind(Object(F.a)(n)),n.checkAnswer=n.checkAnswer.bind(Object(F.a)(n)),n.resetButtonStyles=n.resetButtonStyles.bind(Object(F.a)(n)),n.savePlayerToStorage=n.savePlayerToStorage.bind(Object(F.a)(n)),n.savePoints=n.savePoints.bind(Object(F.a)(n)),n}return Object(B.a)(t,e),Object(q.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.playerState;this.shuffleAnswers(),localStorage.setItem("state",JSON.stringify({player:e}))}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.question,a=t.isToStopTime,r=this.state.answered;e.question.correct_answer!==n.correct_answer&&this.shuffleAnswers(),a&&!r&&this.checkAnswer({target:{value:"errado"}})}},{key:"resetButtonStyles",value:function(){this.setState({correctBtnClass:"",incorrectBtnClass:""})}},{key:"shuffleAnswers",value:function(){var e=this.props.question,t=[].concat(Object(W.a)(e.incorrect_answers),[e.correct_answer]);t.sort((function(){return Math.random()-.5})),this.setState({answers:t,answered:!1})}},{key:"savePoints",value:function(e){var t;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.props.addPoints,n.next=3,b.a.awrap(t(e));case 3:this.savePlayerToStorage();case 4:case"end":return n.stop()}}),null,this)}},{key:"savePlayerToStorage",value:function(){var e=this.props.playerState;localStorage.setItem("state",JSON.stringify({player:e}))}},{key:"checkAnswer",value:function(e){var t=e.target,n=this.props,a=n.question,r=n.stopTheTimer,c=n.timer,s=n.corretAnswer,i=a.difficulty;if(r(),t.value===a.correct_answer){var o=10+c*(["easy","medium","hard"].indexOf(i)+1);this.savePoints(o),s()}this.setState({correctBtnClass:"correct-btn",incorrectBtnClass:"incorrect-btn",answered:!0})}},{key:"render",value:function(){var e=this;g();var t=this.props,n=t.question,a=t.isToStopTime,c=t.funct,s=this.state,i=s.answers,o=s.correctBtnClass,u=s.incorrectBtnClass,l=s.answered;return r.a.createElement("div",{className:"question"},r.a.createElement("h3",{"data-testid":"question-category"},n.category),r.a.createElement("p",{"data-testid":"question-text"},n.question),i.map((function(t){var c=t===n.correct_answer;return r.a.createElement("input",{key:t,"data-testid":c?"correct-answer":"wrong-answer-".concat(n.incorrect_answers.indexOf(t)),type:"button",value:t,className:"answer ".concat(c?o:u),onClick:e.checkAnswer,disabled:a})})),l?r.a.createElement(Y,{resetStyles:this.resetButtonStyles,funct:c}):null)}}]),t}(r.a.Component),$=Object(i.b)((function(e){return{isToStopTime:e.game.stopTime,timer:e.game.time,playerState:e.player}}),(function(e){return{stopTheTimer:function(){return e({type:"STOP_TIME"})},addPoints:function(t){return e(function(e){return{type:"INCREASE_SCORE",points:e}}(t))},corretAnswer:function(){return e({type:"INCREASE_ASSERTIONS"})}}}))(Z),ee=(n(214),[]),te=function(e){function t(){var e;return Object(R.a)(this,t),(e=Object(H.a)(this,Object(M.a)(t).call(this))).updateTheTime=e.updateTheTime.bind(Object(F.a)(e)),e}return Object(B.a)(t,e),Object(q.a)(t,[{key:"componentDidMount",value:function(){var e=setInterval(this.updateTheTime,1e3);ee.push(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.isToStopTime;if(e.isToStopTime!==t){var n=setInterval(this.updateTheTime,1e3);ee.push(n)}}},{key:"updateTheTime",value:function(){var e=this.props,t=e.currentTime,n=e.isToStopTime,a=e.descrease,r=e.stop;0===t||n?(r(),ee.forEach(clearInterval)):a()}},{key:"timerClassName",value:function(e){return e>10?e%2===0?"timer timer-even":"timer timer-odd":e%2===0?"timer timer-ten-sec-even":"timer timer-ten-sec-odd"}},{key:"render",value:function(){var e=this.props.currentTime;return r.a.createElement("div",{className:this.timerClassName(e)},"Tempo Restante: ".concat(e))}}]),t}(r.a.Component),ne=Object(i.b)((function(e){return{currentTime:e.game.time,isToStopTime:e.game.stopTime}}),(function(e){return{descrease:function(){return e({type:"DECREASE_TIME"})},stop:function(){return e({type:"STOP_TIME"})}}}))(te),ae=function(e){function t(e){var n;return Object(R.a)(this,t),(n=Object(H.a)(this,Object(M.a)(t).call(this,e))).state={questions:null,isLoading:!0,questionIndex:0},n.nextQ=n.nextQ.bind(Object(F.a)(n)),n}return Object(B.a)(t,e),Object(q.a)(t,[{key:"componentDidMount",value:function(){var e=this;(function(e){var t,n;return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if("no token in storage"!==(t=E())){a.next=5;break}return a.next=4,b.a.awrap(S());case 4:t=a.sent;case 5:return a.next=7,b.a.awrap(k(t,e));case 7:if("token expired"!==(n=a.sent)){a.next=19;break}return a.next=11,b.a.awrap(S());case 11:return t=a.sent,a.t0=b.a,a.next=15,b.a.awrap(k(t));case 15:return a.t1=a.sent,a.next=18,a.t0.awrap.call(a.t0,a.t1);case 18:n=a.sent;case 19:return a.abrupt("return",n);case 20:case"end":return a.stop()}}))})(this.props.settings).then((function(t){return e.setState({questions:t,isLoading:!1})}))}},{key:"componentWillUnmount",value:function(){g();var e=JSON.parse(localStorage.getItem("state")),t=JSON.parse(localStorage.getItem("ranking")),n=[].concat(Object(W.a)(t),[e]);n.sort((function(e,t){return t.player.score-e.player.score}));var a=JSON.stringify(n);localStorage.setItem("ranking",a)}},{key:"nextQ",value:function(){var e=this.props.resetTimer;this.setState((function(e){return{questionIndex:e.questionIndex+1}})),e()}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.questions,a=e.questionIndex;return 5===a?r.a.createElement(J.a,{to:"/feedback"}):r.a.createElement("div",null,r.a.createElement(X,null),r.a.createElement(ne,null),t?r.a.createElement("p",null,"Loading..."):r.a.createElement($,{funct:this.nextQ,question:n[a]}))}}]),t}(r.a.Component),re=Object(i.b)((function(e){return{question:e.game.questions,settings:{selectedCategory:e.game.selectedCategory,selectedDifficulty:e.game.selectedDifficulty,selectedType:e.game.selectedType}}}),(function(e){return{resetTimer:function(){return e({type:"RESET_TIME"})}}}))(ae),ce=(n(216),function(e){function t(){return Object(R.a)(this,t),Object(H.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(B.a)(t,e),Object(q.a)(t,[{key:"render",value:function(){var e=JSON.parse(localStorage.getItem("ranking"));return r.a.createElement("div",{className:"ranking"},r.a.createElement("h1",{"data-testid":"ranking-title"},"Ranking"),r.a.createElement("ol",null,e.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("p",null,"".concat(t+1,".")),r.a.createElement("p",{className:"ranking-mid","data-testid":"player-name-".concat(t)},e.player.name),r.a.createElement("p",{"data-testid":"player-score-".concat(t)},e.player.score),r.a.createElement("img",{src:e.player.gravatarUrl,alt:"Avatar"}))}))),r.a.createElement(o.b,{to:"/","data-testid":"btn-go-home"},r.a.createElement("button",{type:"button"},"Tela inicial")))}}]),t}(r.a.Component)),se=(n(217),function(e){function t(){return Object(R.a)(this,t),Object(H.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(B.a)(t,e),Object(q.a)(t,[{key:"render",value:function(){var e=this.props.player,t=e.assertions,n=e.score;return r.a.createElement(r.a.Fragment,null,r.a.createElement(X,null),r.a.createElement("section",{className:"feedback"},r.a.createElement("h1",{"data-testid":"feedback-text"},t>=3?"Mandou bem!":"Podia ser melhor..."),r.a.createElement("p",null,"Voc\xea acertou",r.a.createElement("span",{"data-testid":"feedback-total-question"}," ",t," "),1===t?"quest\xe3o":"quest\xf5es"),r.a.createElement("p",null,"Um total de",r.a.createElement("span",{"data-testid":"feedback-total-score"}," ",n," "),"pontos."),r.a.createElement("div",null,r.a.createElement(o.b,{to:"/ranking"},r.a.createElement("button",{type:"button","data-testid":"btn-ranking"},"Ver Ranking")),r.a.createElement(o.b,{to:"/"},r.a.createElement("button",{type:"button","data-testid":"btn-play-again"},"Jogar Novamente")))))}}]),t}(r.a.Component)),ie=Object(i.b)((function(e){return{player:e.player}}),null)(se),oe=(n(218),function(e){function t(){return Object(R.a)(this,t),Object(H.a)(this,Object(M.a)(t).apply(this,arguments))}return Object(B.a)(t,e),Object(q.a)(t,[{key:"render",value:function(){return g(),r.a.createElement(J.d,null,r.a.createElement(J.b,{exact:!0,path:"/settings",render:function(e){return r.a.createElement(K,e)}}),r.a.createElement(J.b,{exact:!0,path:"/",render:function(e){return r.a.createElement(G,e)}}),r.a.createElement(J.b,{exact:!0,path:"/game",render:function(e){return r.a.createElement(re,e)}}),r.a.createElement(J.b,{exact:!0,path:"/ranking",render:function(e){return r.a.createElement(ce,e)}}),r.a.createElement(J.b,{exact:!0,path:"/feedback",render:function(e){return r.a.createElement(ie,e)}}))}}]),t}(r.a.Component));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,{store:D},r.a.createElement(o.a,{basename:"/TriviaGame"},r.a.createElement(oe,null)))),document.getElementById("root"))}},[[114,1,2]]]);
//# sourceMappingURL=main.b2209aab.chunk.js.map